{% extends "base.html" %} {% block content %}
<h2>Image Classifier</h2>

<div>
  <form id="upload-file" method="post" enctype="multipart/form-data">
    <label for="imageUpload" class="upload-label"> Choose... </label>
    <input
      type="file"
      name="file"
      id="imageUpload"
      accept=".png, .jpg, .jpeg"
    />
  </form>

  <div class="image-section" style="display: none">
    <div class="img-preview">
      <div id="imagePreview"></div>
    </div>
    <div>
      <button type="button" class="btn btn-primary btn-lg" id="btn-predict">
        Predict!
      </button>
    </div>
  </div>

  <div class="loader" style="display: none"></div>

  <h3 id="result">
    <span></span>
  </h3>
</div>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function () {
    $("#btn-predict").click(function () {
      var form_data = new FormData($("#upload-file")[0]);
      $.ajax({
        type: "POST",
        url: "/predict",
        data: form_data,
        contentType: false,
        processData: false,
        async: true,
        cache: false,
        beforeSend: function () {
          $("#result").text("");
          $(".loader").css("display", "block");
        },
        success: function (response) {
          $("#result span").text(response);
          $(".loader").css("display", "none");
        },
      });
    });
  });
</script>
{% endblock %}
